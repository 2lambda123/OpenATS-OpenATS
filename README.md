# OpenATS
欢迎使用OpenATS天线追踪系统（Open Antenna Tracking System）



需要的硬件：
  电脑一台，用来运行WXtrack卫星跟踪软件。
  Arduino，山寨或者正版都可以，正版可以购买Genuino，分Nano和Mega等版本，建议Mega，拥有更好的处理能力和内存，并且以后扩展好。国内正版版本大概140元左右。Nano大概80左右，山寨30-50左右。山寨也正常，我的实验平台就是在山寨上运行的
  步进电机2个，最好用57步进电机，扭距选择大一些的，2.0Nm以上最好，当然还可以通过减速机来增大扭矩。
  步进电机驱动器2个，分别控制步进电机的。1套驱动器配1个步进电机，57步进套装在200-300左右，当然可以淘二手的。
  24V开关电源一个，工业上用的即可，淘宝很多，具体功率要根据你两个步进电机的功率之和来决定。如果选57大功率的步进电机的话，就要选择最少10A以上的电源
。
  再一个不起眼但很重要的，XY轴可以旋转的支架。这个不好购买，可以自己制作，成本不太好估计。
  如果不算支架的话，仅需要几百块钱就可以完成所实现的功能，加上支架成本，不到2k应该足够了。具体看你用没用减速机还有支架配件等等，有的配件，我们身边都有。


搭建过程：

所有程序和代码，已经分享到我的百度网盘，地址：http://pan.baidu.com/s/1i5jR1I1


1，把Arduino驱动程序arduino-1.6.8-windows.exe和虚拟串口软件驱动CH341SER.EXE下载安装，把AccelStepper库下载解压缩，解压缩后的整个AccelStepper文件夹拷贝到安装后Arduino程序的libraries文件夹下
   将追踪天线代码上传到Arduino板子中。

2，搭建硬件，具体硬件接线图，可以看图片。简单就是用Arduino的PWM接口，来发送脉冲。AZ方位角的控制接口是3，dir方向控制是5，EL仰角的控制接口是6，dir方向控制是9。采用共阴接法或者共阳接法都可以。
   
   AZ方位角的CLK+(有的驱动器上也叫PUL+)接到Arduino的数字接口3，CW+(有的也叫DIR+）接到数字口5，EL仰角的CLK+接到6，CW+接到9上
   AZ方位角驱动器上的CLK-，CW-接到一起，再接到arduino的一个GND接口。EL仰角驱动器的CLK-，CW-接到一起，再接到Arduino的另一个GND接口。
   剩余的EN+（有的也叫ENA+）还有EN-我们都不接。

3，步进电机与驱动器的接线，步进电机比如常见的2相四线电机，分A+,A-,B+,B-接线，在驱动器上都有标识，自行按照自己步进电机的线颜色定义接上即可。驱动器上的电源接开关电源的输出即可，开关电源给两个驱动器供电24V电压。
   注意正负极。



使用说明：

（一）自动追踪

  自动追踪，电脑下载运行WXtrack软件，更新星历，星历更新会提示联不上网或者更新失败，我们手动去下载星历文件放到程序的文件夹下面即可。
  电脑运行WXtrack软件，找到顶部菜单，Tracker--Options..然后打开设置天线追踪器界面，然后我们点击选中EasyComm I COM port，
  下面的窗口，pass start可以设置1，意思是1分钟之前就唤醒天线。Pass end就是追踪完成后发送什么指令，我们输入我们天线的复位指令：“S”，
  Parking意思是停止天线，我们选中Park antenna，其余不用改。再切换到Port setup菜单，选中你的arduino对应的COM口，比如COM4，速率选中程序中设置的9600
  然后是进入Tracker-specific options菜单，将EasyComm precision（精确度控制）设置为2，这样程序输出的串口数据会保留小数点2位，否则是整数，整个系统精确度很低。
  电脑软件我们就设置完成了。调试好角度后，就可以自动追踪啦！

（二）手动控制

如果手动控制，请打开Arduino的IDE自带的串口监视器或者用别的可以发送串口数据的软件（各种串口调试工具都可以），用来做手动控制

设置你的Arduino对应的串口编号，然后设置波特率9600。
在发送角度命令时，按照如下格式：方位角 仰角（AZ EL），中间为空格，数据为浮点数或者整数，比如发送：20 40，则天线方位角转到20度，仰角到40度。
等同于：20.0 40.0  可以输入小数点儿，细分大的话，程序的识别能力可以精确到0.1度。
如果仅仅输入一位数字，则只调动方位角，仰角便为0.比如：20则天线默认将方位角转到20度，仰角为0度。输入R或者0都可以将天线复位，即方位角仰角都为0度。

以下功能没测试，不能正常运行请见谅，待以后测试更新。
校准功能
在长时间运转后，天线可能会由于电机的丢步，造成的精度不准，这时候可以输入命令来进行校准。为了简单明了来调整天线，AZ跟EL分开调整。
调整方位角的命令为：AA23 就是大写字母A后面紧跟一个数字，可以是浮点数也可以是整数。就是把天线当前的角度调整为23度。
调整仰角的命令便为：EE56 原理同上。



后续：

本人水平有限，非程序员，只是个普通工人，工作繁忙。Arduino的代码也没有仔细学，只是为了达到我的目的而去补的知识
代码如果不好，请见谅。公开代码就是让大家都能自己制作自己的追踪系统，不必花那么多钱买商业的成品。代码中已经注释的非常详细

希望更多的人完善我们的天线，来将我们的天线越做越好。在此祝福大家在玩无线电的过程中享受乐趣。

web:
http://www.freebuf.com/articles/wireless/112380.html

73
